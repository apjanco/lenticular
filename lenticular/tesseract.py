import textract 
from rich import print 

def get_text(temp_file:str,language_select:str) -> str:
    assert language_select in languages.keys(), f"[red]Language must be one of {languages.keys()}[/red]"
    try:
        text = textract.process(temp_file, language=language_select)
        text = text.decode('utf-8')
        if '\x0c' in text: # Odd bit of binary (end page) that sneaks in
            text = text.replace('\x0c','')
        return text
    except Exception as e:
        return str(e)
    
languages = {
  "afr":"Afrikaans",
  "amh":"Amharic",
  "ara":"Arabic",
  "asm":"Assamese",
  "aze":"Azerbaijani",
  "cyrl":"Uzbek (Cyrillic)",
  "bel":"Belarusian",
  "ben":"Bengali",
  "bod":"Tibetan Standard",
  "bos":"Bosnian",
  "bre":"Breton",
  "bul":"Bulgarian",
  "cat":"Catalan",
  "ceb":"Cebuano",
  "ces":"Czech",
  "sim":"Chinese - Simplified",
  "vert":"Japanese (vertical) script",
  "tra":"Chinese - Traditional",
  "chr":"Cherokee",
  "cos":"Corsican",
  "cym":"Welsh",
  "dan":"Danish",
  "deu":"German",
  "div":"Divehi",
  "dzo":"Dzongkha",
  "ell":"Greek",
  "eng":"English",
  "enm":"English, Middle (1100-1500)",
  "epo":"Esperanto",
  "est":"Estonian",
  "eus":"Basque",
  "fao":"Faroese",
  "fas":"Persian",
  "fil":"Filipino",
  "fin":"Finnish",
  "fra":"French",
  "frk":"German (Fraktur)",
  "frm":"French, Middle (ca.1400-1600)",
  "fry":"Frisian (Western)",
  "gla":"Gaelic (Scots)",
  "gle":"Irish",
  "glg":"Galician",
  "grc":"Greek, Ancient (to 1453)",
  "guj":"Gujarati",
  "hat":"Haitian",
  "heb":"Hebrew",
  "hin":"Hindi",
  "hrv":"Croatian",
  "hun":"Hungarian",
  "hye":"Armenian",
  "iku":"Inuktitut",
  "ind":"Indonesian",
  "isl":"Icelandic",
  "ita":"Italian",
  "old":"Spanish, Castilian - Old",
  "jav":"Javanese",
  "jpn":"Japanese",
  "kan":"Kannada",
  "kat":"Georgian",
  "kaz":"Kazakh",
  "khm":"Khmer",
  "kir":"Kyrgyz",
  "kmr":"Kurmanji (Latin)",
  "kor":"Korean",
  "lao":"Lao",
  "lat":"Latin",
  "lav":"Latvian",
  "lit":"Lithuanian",
  "ltz":"Luxembourgish",
  "mal":"Malayalam",
  "mar":"Marathi",
  "mkd":"Macedonian",
  "mlt":"Maltese",
  "mon":"Mongolian",
  "mri":"Maori",
  "msa":"Malay",
  "mya":"Burmese",
  "nep":"Nepali",
  "nld":"Dutch",
  "nor":"Norwegian",
  "oci":"Occitan (post 1500)",
  "ori":"Oriya",
  "osd":"script and orientation",
  "pan":"Punjabi",
  "pol":"Polish",
  "por":"Portuguese",
  "pus":"Pashto",
  "que":"Quechua",
  "ron":"Romanian",
  "rus":"Russian",
  "san":"Sanskrit",
  "arab":"Arabic script",
  "armn":"Armenian script",
  "beng":"Bengali script",
  "cans":"Canadian Aboriginal script",
  "cher":"Cherokee script",
  "deva":"Devanagari script",
  "ethi":"Ethiopic script",
  "frak":"Fraktur script",
  "geor":"Georgian script",
  "grek":"Greek script",
  "gujr":"Gujarati script",
  "guru":"Gurmukhi script",
  "hang":"Hangul script",
  "hans":"Han - Simplified script",
  "hant":"Han - Traditional script",
  "hebr":"Hebrew script",
  "jpan":"Japanese script",
  "khmr":"Khmer script",
  "knda":"Kannada script",
  "laoo":"Lao script",
  "latn":"Serbian (Latin)",
  "mlym":"Malayalam script",
  "mymr":"Myanmar script",
  "orya":"Oriya (Odia) script",
  "sinh":"Sinhala script",
  "syrc":"Syriac script",
  "taml":"Tamil script",
  "telu":"Telugu script",
  "thaa":"Thaana script",
  "thai":"Thai script",
  "tibt":"Tibetan script",
  "viet":"Vietnamese script",
  "sin":"Sinhala",
  "slk":"Slovakian",
  "slv":"Slovenian",
  "snd":"Sindhi",
  "spa":"Spanish",
  "sqi":"Albanian",
  "srp":"Serbian",
  "sun":"Sundanese",
  "swa":"Swahili",
  "swe":"Swedish",
  "syr":"Syriac",
  "tam":"Tamil",
  "tat":"Tatar",
  "tel":"Telugu",
  "tgk":"Tajik",
  "tha":"Thai",
  "tir":"Tigrinya",
  "ton":"Tonga",
  "tur":"Turkish",
  "uig":"Uyghur",
  "ukr":"Ukrainian",
  "urd":"Urdu",
  "uzb":"Uzbek",
  "vie":"Vietnamese",
  "yid":"Yiddish",
  "yor":"Yoruba"
}